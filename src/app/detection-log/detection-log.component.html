<div class="detection-log">
    <div class="detection-log__main">
        <div class="detection-log__header">
            <div class="detection-log__header-content">
                <h2 class="detection-log__title">Detection Log</h2>
                <div class="detection-log__actions">
                    <button class="detection-log__action-btn" (click)="toggleFilter()">
                        <span class="material-icons">filter_list</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="detection-log__content">
            <div class="detection-log__filters" *ngIf="isFilterOpen">
                <div class="filter-group">
                    <label for="confidence">Confidence Threshold: {{confidenceThreshold * 100}}%</label>
                    <input
                        type="range"
                        id="confidence"
                        [(ngModel)]="confidenceThreshold"
                        min="0"
                        max="1"
                        step="0.1"
                        class="filter-slider"
                    >
                </div>
                <div class="filter-group">
                    <label for="sort">Sort By</label>
                    <select id="sort" [(ngModel)]="sortBy" class="filter-select">
                        <option value="time">Time</option>
                        <option value="confidence">Confidence</option>
                    </select>
                </div>
            </div>

            <div class="detection-log__list">
                <div *ngFor="let detection of filteredDetections" 
                     class="detection-item"
                     [class.high-risk]="detection.confidence > 0.8"
                     [class.medium-risk]="detection.confidence > 0.5 && detection.confidence <= 0.8"
                     [class.low-risk]="detection.confidence <= 0.5">
                    <div class="detection-item__header" (click)="toggleExpanded(detection.id)">
                        <span class="material-icons detection-item__icon">
                            {{detection.confidence > 0.8 ? 'priority_high' : 'warning'}}
                        </span>
                        <div class="detection-item__info">
                            <div class="detection-item__title">
                                <span>{{ detection.threatType || 'Threat' }} Detected</span>
                                <span class="material-icons expand-icon">
                                    {{ isExpanded(detection.id) ? 'expand_less' : 'expand_more' }}
                                </span>
                            </div>
                            <div class="detection-item__details">
                                <p>Location: {{detection.location}}</p>
                                <p>Time: {{detection.timestamp | date:'short'}}</p>
                                <p>Confidence: {{detection.confidence | percent}}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div *ngIf="isExpanded(detection.id)" class="detection-item__image">
                        <img *ngIf="detection.imageUrl" [src]="detection.imageUrl" alt="Detection snapshot">
                        <p *ngIf="!detection.imageUrl" class="detection-item__image__no-image">
                            No image available for this detection
                        </p>
                    </div>
                </div>

                <div *ngIf="filteredDetections.length === 0" class="detection-log__empty">
                    <span class="material-icons">search_off</span>
                    <p>No detections found matching the current filters</p>
                </div>
            </div>
        </div>
    </div>
</div>